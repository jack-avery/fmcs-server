FROM amazoncorretto:20-alpine

WORKDIR /fmcs
# Install Forge Server
RUN wget -O forge-{{ item.minecraft_ver }}-{{ item.forge_ver }}-installer.jar https://maven.minecraftforge.net/net/minecraftforge/forge/{{ item.minecraft_ver }}-{{ item.forge_ver }}/forge-{{ item.minecraft_ver }}-{{ item.forge_ver }}-installer.jar
RUN java -jar forge-{{ item.minecraft_ver }}-{{ item.forge_ver }}-installer.jar --installServer
RUN rm forge-{{ item.minecraft_ver }}-{{ item.forge_ver }}-installer.jar

WORKDIR /fmcs/mods
# Install Mods
{% for mod, v in item.mods.items() %}
RUN wget -O "{{ mod }}.jar" https://www.curseforge.com/api/v1/mods/{{ v.project }}/files/{{ v.file }}/download
{% endfor %}

# Copy in generated items
WORKDIR /fmcs
COPY . .

ENTRYPOINT [ "./run.sh" ]
